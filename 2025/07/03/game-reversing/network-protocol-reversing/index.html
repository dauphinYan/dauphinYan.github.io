<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>èµ›å°”å·é€†å‘ï¼šå°åŒ…åˆ†æ - Orcaä¸¶çš„åšå®¢</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Orcaä¸¶çš„åšå®¢"><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Orcaä¸¶çš„åšå®¢"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="èµ›å°”å·å°åŒ…æŠ“å–ä¸åˆ†æã€‚"><meta property="og:type" content="blog"><meta property="og:title" content="èµ›å°”å·é€†å‘ï¼šå°åŒ…åˆ†æ"><meta property="og:url" content="https://github.com/dauphinYan/dauphinYan.github.io.git/2025/07/03/game-reversing/network-protocol-reversing/"><meta property="og:site_name" content="Orcaä¸¶çš„åšå®¢"><meta property="og:description" content="èµ›å°”å·å°åŒ…æŠ“å–ä¸åˆ†æã€‚"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250703234524740.png"><meta property="og:image" content="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704105801081.png"><meta property="og:image" content="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704200337930.png"><meta property="og:image" content="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704202111919.jpg"><meta property="og:image" content="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/wechat_2025-07-08_114622_738.png"><meta property="og:image" content="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704232253744.jpg"><meta property="og:image" content="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704232406825.jpg"><meta property="article:published_time" content="2025-07-03T07:47:54.000Z"><meta property="article:modified_time" content="2025-08-13T15:24:41.835Z"><meta property="article:author" content="Orcaä¸¶"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250703234524740.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/dauphinYan/dauphinYan.github.io.git/2025/07/03/game-reversing/network-protocol-reversing/"},"headline":"èµ›å°”å·é€†å‘ï¼šå°åŒ…åˆ†æ","image":["https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250703234524740.png","https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704105801081.png","https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704200337930.png","https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704202111919.jpg","https://blog-1314504743.cos.ap-nanjing.myqcloud.com/wechat_2025-07-08_114622_738.png","https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704232253744.jpg","https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704232406825.jpg"],"datePublished":"2025-07-03T07:47:54.000Z","dateModified":"2025-08-13T15:24:41.835Z","author":{"@type":"Person","name":"Orcaä¸¶"},"publisher":{"@type":"Organization","name":"Orcaä¸¶çš„åšå®¢","logo":{"@type":"ImageObject","url":"https://github.com/img/favicon.ico"}},"description":"èµ›å°”å·å°åŒ…æŠ“å–ä¸åˆ†æã€‚"}</script><link rel="canonical" href="https://github.com/dauphinYan/dauphinYan.github.io.git/2025/07/03/game-reversing/network-protocol-reversing/"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/favicon.ico" alt="Orcaä¸¶çš„åšå®¢" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">ä¸»é¡µ</a><a class="navbar-item" href="/archives">å½’æ¡£</a><a class="navbar-item" href="/categories">åˆ†ç±»</a><a class="navbar-item" href="/">å…³äº</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/dauphinYan"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="ç›®å½•" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-07-03T07:47:54.000Z" title="2025/7/3 15:47:54">2025-07-03</time>å‘è¡¨</span><span class="level-item"><time dateTime="2025-08-13T15:24:41.835Z" title="2025/8/13 23:24:41">2025-08-13</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/%E8%B5%9B%E5%B0%94%E5%8F%B7%E9%80%86%E5%90%91/">èµ›å°”å·é€†å‘</a></span></div></div><h1 class="title is-3 is-size-4-mobile">èµ›å°”å·é€†å‘ï¼šå°åŒ…åˆ†æ</h1><div class="content"><p>æ–‡ç« å†…å®¹å®Œå–„ä¸­â€¦â€¦</p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä½œè€…æ˜¯ä¸€åèµ›å°”å·PVPç©å®¶ï¼Œæœ€è¿‘èƒœç‡ä¸€ç›´ä¸é«˜ï¼Œå› æ­¤å†³å®šåˆ¶ä½œä¸€æ¬¾å·…å³°è¾…åŠ©å·¥å…·ã€‚</p>
<p>æœ¬äººæ­¤å‰ä»æœªæ¥è§¦è¿‡ç½‘ç»œé€šä¿¡è¿™ä¸€å—ï¼ŒåŸºæœ¬æ˜¯ç°å­¦ç°ç”¨ï¼Œå› æ­¤å¯èƒ½ä¼šå­˜åœ¨éƒ¨åˆ†é—®é¢˜ï¼Œè¿˜æœ›å¤§ä½¬ä»¬æŒ‡å‡ºï¼</p>
<p>æœ¬æ–‡æ‰€ç”¨å·¥å…·å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>å·¥å…·</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>Fiddler Classic</td>
<td>æŠ“åŒ…å·¥å…·</td>
</tr>
<tr>
<td>JPEXS Free Flash Decompiler</td>
<td>Flashæ–‡ä»¶åç¼–è¯‘å·¥å…·</td>
</tr>
<tr>
<td>x64dbg</td>
<td>ç¨‹åºè°ƒè¯•å™¨</td>
</tr>
</tbody></table>
<p>é¡¹ç›®å¼€æºåœ°å€ï¼š<a href="https://github.com/dauphinYan/SeerAssistant">https://github.com/dauphinYan/SeerAssistant</a></p>
<h3 id="è·å–Flashæ–‡ä»¶å¹¶åç¼–è¯‘"><a href="#è·å–Flashæ–‡ä»¶å¹¶åç¼–è¯‘" class="headerlink" title="è·å–Flashæ–‡ä»¶å¹¶åç¼–è¯‘"></a>è·å–Flashæ–‡ä»¶å¹¶åç¼–è¯‘</h3><p>æœ¬é˜¶æ®µç”¨åˆ°çš„å·¥å…·ï¼šFiddler Classicã€JPEXS Free Flash Decompilerã€‚</p>
<p>è¿™éƒ¨åˆ†æš‚æ—¶è·³è¿‡â€¦ï¼ˆå¯ä»¥å‚è€ƒæ–‡æœ«é“¾æ¥ï¼‰</p>
<p>åç¼–è¯‘æˆåŠŸåï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸‹è¿°å››ä¸ªæ–‡ä»¶å¤¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Client</span><br><span class="line">RobotAppDLL</span><br><span class="line">RobotCoreDLL</span><br><span class="line">TaomeeLibrary</span><br></pre></td></tr></table></figure>

<h3 id="å°è¯•è¯»æºç ï¼"><a href="#å°è¯•è¯»æºç ï¼" class="headerlink" title="å°è¯•è¯»æºç ï¼"></a>å°è¯•è¯»æºç ï¼</h3><h4 id="é€šä¿¡æ•°æ®è§£å¯†"><a href="#é€šä¿¡æ•°æ®è§£å¯†" class="headerlink" title="é€šä¿¡æ•°æ®è§£å¯†"></a>é€šä¿¡æ•°æ®è§£å¯†</h4><p>æˆ‘ä»¬å¯ä»¥åœ¨å‰é¢åç¼–è¯‘å¾—åˆ°çš„<code>TaomeeLibrary</code>æ–‡ä»¶å¤¹ä¸­æœç´¢<code>socket</code>ï¼Œæ¯•ç«Ÿç½‘ç»œé€šä¿¡éƒ½éœ€è¦ä½¿ç”¨åˆ°<code>socket</code>ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•å¿«é€Ÿæ¥è¿‘ç›®æ ‡ã€‚ç„¶åï¼Œæˆ‘ä»¬å‘ç°äº†ååˆ†æ˜¾çœ¼çš„<code>MDecrypt.as</code>ï¼Œèµ¶å¿«è¿›å»ç§ç§ï¼</p>
<img src="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250703234524740.png" alt="image-20250703234524740" style="zoom:67%;" />

<p>å¯ä»¥çœ‹åˆ°<code>MDecrypt.as</code>çš„ä¸»è¦å‡½æ•°ä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> function <span class="title">MDecrypt</span><span class="params">(param1:ByteArray, param2:<span class="type">int</span>, param3:ByteArray)</span> : void</span></span><br></pre></td></tr></table></figure>

<p>å› æ­¤æˆ‘ä»¬éœ€è¦å¼„æ¸…ä¼ å…¥çš„ä¸‰ä¸ªå‚æ•°å¯¹åº”çš„å«ä¹‰ã€‚</p>
<p>åŒæ ·ï¼Œåœ¨<code>TameeLibrary</code>æ–‡ä»¶å¤¹ä¸­æœç´¢<code>MDecrypt(</code>ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæŠ€å·§ï¼Œåœ¨æœ«å°¾æ·»åŠ <code>(</code>å°±å¯ä»¥å¿«é€Ÿæ‰¾åˆ°è¯¥å‡½æ•°åœ¨å“ªé‡Œå®ç°ä»¥åŠè°ƒç”¨ã€‚</p>
<img src="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704105801081.png" alt="image-20250704105801081" style="zoom:67%;" />

<p>ç°åœ¨å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°åœ¨<code>MessageEncrypt.as</code>ä¸­æœ‰è°ƒç”¨ï¼Œæˆ‘ä»¬è¿›å»çœ‹çœ‹ã€‚</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">var</span> NO_ENCRYPT_LEN:<span class="built_in">int</span> = <span class="number">4</span>;  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> function <span class="title">decrypt</span>(<span class="params">inData:ByteArray</span>) : ByteArray</span></span><br><span class="line">  &#123;</span><br><span class="line">     <span class="keyword">var</span> inLen:<span class="built_in">int</span> = inData.readUnsignedInt() - NO_ENCRYPT_LEN;</span><br><span class="line">     <span class="keyword">var</span> outData:ByteArray = <span class="keyword">new</span> ByteArray();</span><br><span class="line">     outData.writeUnsignedInt(<span class="number">0</span>);</span><br><span class="line">     MDecrypt(inData,inLen,outData);</span><br><span class="line">     outData.position = <span class="number">0</span>;</span><br><span class="line">     outData.writeUnsignedInt(outData.length);</span><br><span class="line">     outData.position = <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">return</span> outData;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡è¿™ä¸ªå‡½æ•°å®ç°ï¼Œå¯ä»¥å¤§èƒ†çŒœæµ‹ï¼š</p>
<ul>
<li><code>InData</code>ï¼šä¼ å…¥çš„æ•°æ®åŒ…ã€‚</li>
<li><code>inLen</code>ï¼šçœŸæ­£éœ€è¦è§£å¯†çš„éƒ¨åˆ†ã€‚</li>
<li><code>outData</code>ï¼šè§£å¯†åçš„æ•°æ®åŒ…ã€‚</li>
<li><code>NO_ENCRYPT_LEN</code>ï¼šè®°å½•æ•°æ®åŒ…çš„é•¿åº¦ä¿¡æ¯ã€‚ï¼ˆè¿™é‡Œå¤§èƒ†çŒœæµ‹ï¼Œå‰å››å­—èŠ‚ä¸ºåŒ…ä½“é•¿åº¦ï¼‰</li>
</ul>
<blockquote>
<p>ä¸ºä»€ä¹ˆè¿™ä¹ˆçŒœæµ‹å‘¢ï¼Ÿå› ä¸ºæ•°æ®åœ¨ä¼ é€’çš„è¿‡ç¨‹ä¸­ï¼Œæ•°æ®ä¸æ˜¯é€å­—èŠ‚çš„å‘é€çš„ï¼Œè€Œæ˜¯ä»¥æ•°æ®åŒ…çš„å½¢å¼æˆæ‰¹å‘é€ï¼Œé‚£ä¹ˆå‘é€æ–¹ä¸ºäº†è®©æ¥æ”¶æ–¹åŒºåˆ†æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œé€šå¸¸ä¼šåœ¨æ•°æ®åŒ…å¤´éƒ¨ä¿ç•™æ˜æ–‡ç‰‡æ®µç”¨äºæ ‡è¯†æ•°æ®åŒ…çš„é•¿åº¦ã€‚</p>
</blockquote>
<p><code>MDecrypt.as</code>æºç å¯è¯»æ€§æ¯”è¾ƒå·®ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªè¡Œé˜…è¯»åˆ†æï¼Œä½¿ç”¨C++é‡å†™çš„æºç å¯è§ä¸‹æ–¹ã€‚</p>
<p>C++é‡å†™åçš„è§£å¯†æºç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::vector&lt;<span class="type">uint8_t</span>&gt; <span class="title">Cryptor::Decrypt</span><span class="params">(<span class="type">const</span> std::vector&lt;<span class="type">uint8_t</span>&gt; &amp;Cipher)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">size_t</span> len = Cipher.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">0</span> || Key.<span class="built_in">empty</span>())</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—æ—‹è½¬é‡</span></span><br><span class="line">    <span class="type">int</span> result = Key[(len - <span class="number">1</span>) % Key.<span class="built_in">size</span>()] * <span class="number">13</span> % len;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¯å½¢å³ç§» result ä¸ªå­—èŠ‚</span></span><br><span class="line">    std::vector&lt;<span class="type">uint8_t</span>&gt; rotated = <span class="built_in">Merge</span>(</span><br><span class="line">        <span class="built_in">Slice</span>(Cipher, len - result, len),</span><br><span class="line">        <span class="built_in">Slice</span>(Cipher, <span class="number">0</span>, len - result));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å³ç§»/å·¦ç§»ç»„åˆæ¢å¤åŸå§‹å­—èŠ‚åºåˆ—ï¼ˆå»æ‰æœ€åä¸€ä¸ªå­—èŠ‚ï¼‰</span></span><br><span class="line">    <span class="function">std::vector&lt;<span class="type">uint8_t</span>&gt; <span class="title">plain</span><span class="params">(len - <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        plain[i] = <span class="built_in">static_cast</span>&lt;<span class="type">uint8_t</span>&gt;((rotated[i] &gt;&gt; <span class="number">5</span>) | (rotated[i + <span class="number">1</span>] &lt;&lt; <span class="number">3</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼‚æˆ–è§£å¯†</span></span><br><span class="line">    <span class="type">size_t</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="type">bool</span> NeedBecomeZero = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; plain.<span class="built_in">size</span>(); ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (j == <span class="number">1</span> &amp;&amp; NeedBecomeZero)</span><br><span class="line">        &#123;</span><br><span class="line">            j = <span class="number">0</span>;</span><br><span class="line">            NeedBecomeZero = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (j == Key.<span class="built_in">size</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            j = <span class="number">0</span>;</span><br><span class="line">            NeedBecomeZero = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        plain[i] = <span class="built_in">static_cast</span>&lt;<span class="type">uint8_t</span>&gt;(plain[i] ^ Key[j]);</span><br><span class="line">        ++j;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> plain;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œåœ¨å®˜æ–¹çš„æºç ä¸­</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_loc11_ = CModule.mallocString(getDefinitionByName(<span class="string">&quot;com.robot.core.net.SocketConnection&quot;</span>).key);</span><br></pre></td></tr></table></figure>

<p><code>_loc11_</code>åœ¨å¾ˆå¤šå¤„éƒ½æœ‰å‚ä¸è¿ç®—ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¼„æ¸…æ¥šè¿™ä¸ªå€¼æ˜¯æ€ä¹ˆæ¥çš„ã€‚</p>
<p>æ ¹æ®è·¯å¾„æ‰¾åˆ°<code>SocketConnection.as</code>ï¼Œå‘ç°å…³é”®å‡½æ•°<code>key()</code>ï¼š</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">var</span> _encryptKeyStringArr:Array;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> function <span class="keyword">get</span> <span class="title">key</span>() : String</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">var</span> _loc2_:<span class="built_in">int</span> = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">var</span> _loc3_:String = <span class="literal">null</span>;</span><br><span class="line"> <span class="keyword">var</span> _loc1_:String = <span class="string">&quot;&quot;</span>;</span><br><span class="line"> <span class="keyword">if</span>(_encryptKeyStringArr == <span class="literal">null</span>)</span><br><span class="line"> &#123;</span><br><span class="line">    _loc1_ = <span class="string">&quot;!crAckmE4nOthIng:-)&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> &#123;</span><br><span class="line">    _loc2_ = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(_loc2_ &lt; _encryptKeyStringArr.length)</span><br><span class="line">    &#123;</span><br><span class="line">       _loc3_ = StringUtil.replace(_encryptKeyStringArr[_loc2_],<span class="string">&quot;*&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">       _loc1_ += _loc3_;</span><br><span class="line">       _loc2_++;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> _loc1_;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸éš¾çŸ¥é“ï¼Œé»˜è®¤æƒ…å†µä¸‹<code>key</code>çš„å€¼ä¸º<code>!crAckmE4nOthIng:-)</code>ï¼Œè¿™ä¸ªå¯†é’¥çœ‹ç€å¾ˆåƒæŸäº›å•è¯çš„ç¼©å†™ï¼Œç®€å•è§£è¯»ä¸€ä¸‹ã€‚</p>
<ul>
<li><code>crAckmE</code>ï¼šCrack me.</li>
<li><code>4</code>ï¼šfor.</li>
<li><code>nOthIng</code>ï¼šNothing.</li>
</ul>
<p>è¿èµ·æ¥ä¹Ÿå°±æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Crack me for nothing.   è¯•ç€ç ´è§£æˆ‘å§ï¼Œåæ­£ä¹Ÿæ²¡å•¥æœ‰ç”¨çš„ä¸œè¥¿ğŸ˜Š</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é‡Œæ„Ÿè°¢â€åœ†åœ†åœ†â€œæä¾›çš„è§£é‡Šã€‚</p>
</blockquote>
<p>æ˜¾ç„¶ï¼Œè¿™ä¸ª<code>key</code>åœ¨åé¢è‚¯å®šä¼šè¢«ä¿®æ”¹ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­åˆæ‰¾åˆ°çš„ä¿®æ”¹å‡½æ•°ï¼š</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> function <span class="title">setEncryptKeyStringArr</span>(<span class="params">param1:Array</span>) : <span class="keyword">void</span></span></span><br><span class="line">&#123;</span><br><span class="line"> _encryptKeyStringArr = param1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å› æ­¤åœ¨æ–‡ä»¶å¤¹ä¸­æœç´¢<code>setEncryptKeyStringArr(</code>ï¼Œå¾—åˆ°ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704200337930.png" alt="image-20250704200337930" style="zoom:67%;" />

<p>åªæ‰¾åˆ°ä¸€å¤„è¯¥æ–¹æ³•çš„è°ƒç”¨ï¼Œå’Œæˆ‘ä»¬çš„é¢„æœŸæœ‰æ‰€å·®è·ï¼š</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> function <span class="title">onSocketClose</span>(<span class="params">param1:Event</span>) : <span class="keyword">void</span></span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">var</span> <span class="keyword">event</span>:Event = param1;</span><br><span class="line">   DebugTrace.show(<span class="string">&quot;////////////////////////////////////////////////////////////////////////////////\r//\r//\t\t\t\t&quot;</span> + <span class="string">&quot;socket was closed\r//\r////////////////////////////////////////////////////////////////////////////////&quot;</span>);</span><br><span class="line">   <span class="keyword">try</span></span><br><span class="line">   &#123;</span><br><span class="line">      SocketConnection.mainSocket.removeEventListener(Event.CLOSE,onSocketClose);</span><br><span class="line">      SocketConnection.setEncryptKeyStringArr(<span class="literal">null</span>);</span><br><span class="line">      SocketConnectionHelper.clear();</span><br><span class="line">      ModuleManager.hideAllModule();</span><br><span class="line">      <span class="keyword">if</span>(login10004)</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      Alarm.show(<span class="string">&quot;æ­¤æ¬¡è¿æ¥å·²ç»æ–­å¼€ï¼Œè¯·é‡æ–°ç™»å½•&quot;</span>,function():<span class="keyword">void</span></span><br><span class="line">      &#123;</span><br><span class="line">         <span class="keyword">if</span>(ExternalInterface.available)</span><br><span class="line">         &#123;</span><br><span class="line">            navigateToURL(<span class="keyword">new</span> URLRequest(<span class="string">&quot;javascript:window.location.reload();&quot;</span>),<span class="string">&quot;_self&quot;</span>);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">         &#123;</span><br><span class="line">            navigateToURL(<span class="keyword">new</span> URLRequest(<span class="string">&quot;https://seer.61.com&quot;</span>),<span class="string">&quot;_self&quot;</span>);</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,<span class="literal">false</span>,<span class="literal">true</span>,<span class="literal">false</span>,LevelManager.stage);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">catch</span>(e:Error)</span><br><span class="line">   &#123;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™éƒ¨åˆ†å‘ç”Ÿåœ¨ä¸æ¸¸æˆæœåŠ¡å™¨æ–­å¼€çš„é˜¶æ®µï¼Œå¹¶æ²¡æœ‰è¾¾åˆ°ä¿®æ”¹<code>key</code>çš„ç›®çš„ï¼Œç°åœ¨å°±æ¯”è¾ƒéº»çƒ¦äº†ã€‚</p>
<p>æ—¢ç„¶å¦‚æ­¤ï¼Œé‚£æˆ‘ä»¬å…ˆå»å¼€ä¸€æŠŠä¼‘æ¯ä¸€ä¸‹ï¼Œç¾ç»Šåçš„ä¼½é©¬å¼ºåº¦è¿˜æ˜¯å¤ªçˆ†ç‚¸äº†â€¦â€¦</p>
<img src="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704202111919.jpg" alt="image-20250704202111919" style="zoom: 33%;" />

<h4 id="æ•°æ®åŒ…æ ¼å¼è§£æ"><a href="#æ•°æ®åŒ…æ ¼å¼è§£æ" class="headerlink" title="æ•°æ®åŒ…æ ¼å¼è§£æ"></a>æ•°æ®åŒ…æ ¼å¼è§£æ</h4><p>åœ¨æ‰¾<code>key</code>ä¹‹å‰å‘¢ï¼Œå¯ä»¥å…ˆçœ‹çœ‹å®˜æ–¹æ˜¯å¦‚ä½•è§£ææ•°æ®åŒ…çš„ï¼Œå‰é¢æˆ‘ä»¬çŸ¥é“<code>MessageEncrypt.as</code>æœ‰ä¸€ä¸ª<code>decrypt(</code>å‡½æ•°ï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ä¸€ä¸ªå¥—å£³å‡½æ•°ï¼Œæ²¡æœ‰è§£ææ•°æ®çš„å…·ä½“å®ç°ã€‚å› æ­¤æ–‡ä»¶å¤¹ä¸­æœç´¢<code>decrypt(</code>ï¼Œå¯ä»¥å®šä½åˆ°<code>SocketEncryptImpl.as</code>ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå‡½æ•°ï¼š</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> function <span class="title">onData</span>(<span class="params">e:Event</span>) : <span class="keyword">void</span></span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">var</span> msgLen:<span class="built_in">int</span> = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">var</span> ba:ByteArray = <span class="literal">null</span>;</span><br><span class="line">   DebugTrace.show(<span class="string">&quot;socket onData handler....................&quot;</span>);</span><br><span class="line">   <span class="keyword">this</span>._chunkBuffer.clear();</span><br><span class="line">   <span class="keyword">if</span>(<span class="keyword">this</span>._tempBuffer.length &gt; <span class="number">0</span>)</span><br><span class="line">   &#123;</span><br><span class="line">      <span class="keyword">this</span>._tempBuffer.position = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">this</span>._tempBuffer.readBytes(<span class="keyword">this</span>._chunkBuffer,<span class="number">0</span>,<span class="keyword">this</span>._tempBuffer.length);</span><br><span class="line">      <span class="keyword">this</span>._tempBuffer.clear();</span><br><span class="line">   &#125;</span><br><span class="line">   readBytes(<span class="keyword">this</span>._chunkBuffer,<span class="keyword">this</span>._chunkBuffer.length,bytesAvailable);</span><br><span class="line">   <span class="keyword">this</span>._chunkBuffer.position = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">while</span>(<span class="keyword">this</span>._chunkBuffer.bytesAvailable &gt; <span class="number">0</span>)</span><br><span class="line">   &#123;</span><br><span class="line">      <span class="keyword">if</span>(<span class="keyword">this</span>._chunkBuffer.bytesAvailable &gt; MSG_FIRST_TOKEN_LEN)</span><br><span class="line">      &#123;</span><br><span class="line">         msgLen = <span class="keyword">this</span>._chunkBuffer.readUnsignedInt() - MSG_FIRST_TOKEN_LEN;</span><br><span class="line">         <span class="keyword">if</span>(<span class="keyword">this</span>._chunkBuffer.bytesAvailable &gt;= msgLen)</span><br><span class="line">         &#123;</span><br><span class="line">            <span class="keyword">this</span>._chunkBuffer.position -= MSG_FIRST_TOKEN_LEN;</span><br><span class="line">            ba = MessageEncrypt.decrypt(<span class="keyword">this</span>._chunkBuffer);			<span class="comment">// åœ¨è¿™é‡Œï¼</span></span><br><span class="line">            <span class="keyword">this</span>.parseData(ba);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">         &#123;</span><br><span class="line">            <span class="keyword">this</span>._chunkBuffer.position -= MSG_FIRST_TOKEN_LEN;</span><br><span class="line">            <span class="keyword">this</span>._chunkBuffer.readBytes(<span class="keyword">this</span>._tempBuffer,<span class="number">0</span>,<span class="keyword">this</span>._chunkBuffer.bytesAvailable);</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">         <span class="keyword">this</span>._chunkBuffer.readBytes(<span class="keyword">this</span>._tempBuffer,<span class="number">0</span>,<span class="keyword">this</span>._chunkBuffer.bytesAvailable);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨è§£å¯†å‡½æ•°çš„ä¸‹æ–¹ï¼Œæœ‰ä¸€ä¸ª<code>ParseData</code>å‡½æ•°ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯â€è§£ææ•°æ®â€œã€‚é‚£ä¹ˆæˆ‘ä»¬å®šä½åˆ°é‚£é‡Œå»ï¼š</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">const</span> HEAD_LENGTH:<span class="built_in">uint</span> = <span class="number">17</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> function <span class="title">parseData</span>(<span class="params">data:ByteArray</span>) : <span class="keyword">void</span></span></span><br><span class="line">  &#123;</span><br><span class="line">     <span class="keyword">var</span> info:ByteArray = <span class="literal">null</span>;</span><br><span class="line">     <span class="keyword">var</span> tmfClass:Class = <span class="literal">null</span>;</span><br><span class="line">     <span class="keyword">this</span>._packageLen = data.readUnsignedInt();</span><br><span class="line">     <span class="keyword">if</span>(<span class="keyword">this</span>._packageLen &lt; HEAD_LENGTH || <span class="keyword">this</span>._packageLen &gt; PACKAGE_MAX)</span><br><span class="line">     &#123;</span><br><span class="line">        <span class="keyword">this</span>.readDataError(<span class="number">0</span>);</span><br><span class="line">        dispatchEvent(<span class="keyword">new</span> SocketErrorEvent(SocketErrorEvent.ERROR,<span class="literal">null</span>));</span><br><span class="line">        data.readBytes(<span class="keyword">new</span> ByteArray());</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">this</span>._headInfo = <span class="keyword">new</span> HeadInfo(data);</span><br><span class="line">     <span class="keyword">if</span>(<span class="keyword">this</span>._headInfo.cmdID == <span class="number">1001</span>)</span><br><span class="line">     &#123;</span><br><span class="line">        <span class="keyword">this</span>._result = <span class="keyword">this</span>._headInfo.result;</span><br><span class="line">     &#125;</span><br><span class="line">     DebugTrace.show(<span class="string">&quot;&lt;&lt;Socket[&quot;</span> + <span class="keyword">this</span>.ip + <span class="string">&quot;:&quot;</span> + <span class="keyword">this</span>.port.toString() + <span class="string">&quot;][cmdID:&quot;</span> + <span class="keyword">this</span>._headInfo.cmdID + <span class="string">&quot;]&quot;</span>,getCmdLabel(<span class="keyword">this</span>._headInfo.cmdID));</span><br><span class="line">     <span class="keyword">if</span>(<span class="keyword">this</span>._headInfo.result &gt; <span class="number">1000</span>)</span><br><span class="line">     &#123;</span><br><span class="line">        <span class="keyword">this</span>.readDataError(<span class="keyword">this</span>._headInfo.cmdID);</span><br><span class="line">        <span class="keyword">this</span>.dispatchError(<span class="keyword">this</span>._headInfo.cmdID,<span class="keyword">this</span>._headInfo);</span><br><span class="line">        dispatchEvent(<span class="keyword">new</span> SocketErrorEvent(SocketErrorEvent.ERROR,<span class="keyword">this</span>._headInfo));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">this</span>._dataLen = <span class="keyword">this</span>._packageLen - HEAD_LENGTH;</span><br><span class="line">     <span class="keyword">if</span>(<span class="keyword">this</span>._dataLen == <span class="number">0</span>)</span><br><span class="line">     &#123;</span><br><span class="line">        <span class="keyword">this</span>.readDataError(<span class="keyword">this</span>._headInfo.cmdID);</span><br><span class="line">        <span class="keyword">this</span>.dispatchCmd(<span class="keyword">this</span>._headInfo.cmdID,<span class="keyword">this</span>._headInfo,<span class="literal">null</span>);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">     &#123;</span><br><span class="line">        info = <span class="keyword">new</span> ByteArray();</span><br><span class="line">        data.readBytes(info,<span class="number">0</span>,<span class="keyword">this</span>._dataLen);</span><br><span class="line">        tmfClass = TMF.getClass(<span class="keyword">this</span>._headInfo.cmdID);</span><br><span class="line">        <span class="keyword">this</span>.readDataError(<span class="keyword">this</span>._headInfo.cmdID);</span><br><span class="line">        <span class="keyword">this</span>.dispatchCmd(<span class="keyword">this</span>._headInfo.cmdID,<span class="keyword">this</span>._headInfo,<span class="keyword">new</span> tmfClass(info));</span><br><span class="line">     &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼ŒDebugè¾“å‡ºä¸<code>_headInfo</code>æœ‰å…³ï¼Œé‚£ä¹ˆåŒæ ·çš„æ–¹å¼ï¼Œæˆ‘ä»¬å®šä½åˆ°<code>HeadInfo</code></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> function <span class="title">HeadInfo</span>(<span class="params">headData:IDataInput</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">   super();</span><br><span class="line">   <span class="keyword">this</span>._version = headData.readUTFBytes(<span class="number">1</span>);		<span class="comment">// ç‰ˆæœ¬å·ï¼Œ1å­—èŠ‚</span></span><br><span class="line">   <span class="keyword">this</span>._cmdID = headData.readUnsignedInt();		<span class="comment">// å‘½ä»¤å·ï¼Œ4å­—èŠ‚</span></span><br><span class="line">   <span class="keyword">this</span>._userID = headData.readUnsignedInt();		<span class="comment">// ç”¨æˆ·å·ï¼Œ4å­—èŠ‚</span></span><br><span class="line">   <span class="keyword">this</span>._result = headData.readInt();				<span class="comment">// åºåˆ—å·ï¼Œ4å­—èŠ‚</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†æ¬¡é˜…è¯»ä»£ç ï¼Œç°åœ¨å°åŒ…çš„ç»“æ„å°±ååˆ†æ˜ç¡®äº†ï¼š</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°åŒ…é•¿åº¦, 4å­—èŠ‚|ç‰ˆæœ¬å·ï¼Œ1å­—èŠ‚|å‘½ä»¤å·ï¼Œ4å­—èŠ‚|ç”¨æˆ·å·ï¼Œ4å­—èŠ‚|åºåˆ—å·ï¼Œ4å­—èŠ‚|åŒ…ä½“æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>._packageLen = data.readUnsignedInt();			<span class="comment">// å°åŒ…é•¿åº¦, 4å­—èŠ‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>._headInfo = <span class="keyword">new</span> HeadInfo(data);				<span class="comment">// å¤´éƒ¨ä¿¡æ¯ï¼Œ13å­—èŠ‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>._dataLen = <span class="keyword">this</span>._packageLen - HEAD_LENGTH;		<span class="comment">// åŒ…ä½“é•¿åº¦</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¡¥å……ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°åœ¨<code>parseData()</code>å‡½æ•°ä¸­ï¼Œæœ‰ä¸€å¤„å‘½ä»¤IDçš„åˆ¤æ–­ï¼š</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">this</span>._headInfo.cmdID == <span class="number">1001</span>)</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">this</span>._result = <span class="keyword">this</span>._headInfo.result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å°è¯•åœ¨æ–‡ä»¶å¤¹ä¸­æœç´¢<code>cmdID</code>ï¼Œæ¥ç€æˆ‘ä»¬ä¼šå‘ç°ï¼š</p>
<p><img src="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/wechat_2025-07-08_114622_738.png" alt="wechat_2025-07-08_114622_738"></p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ª<code>cmdID</code>çš„å€¼ä¸º<code>41129</code>ï¼Œæ¥ç€æˆ‘ä»¬ç»§ç»­æœç´¢<code>41129</code>ï¼Œç„¶åæˆ‘ä»¬ä¼šæ‰¾åˆ°<code>CommandID.as</code>æ–‡ä»¶å¤¹ï¼Œè¿™é‡Œé¢å°±åŒ…å«äº†æ‰€æœ‰å‘½ä»¤çš„IDï¼Œä¸‹é¢æˆªå–éƒ¨åˆ†å†…å®¹ï¼š</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package com.robot.core</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CommandID</span></span><br><span class="line">   &#123;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">const</span> LOADING_TIME_STAT:<span class="built_in">uint</span> = <span class="number">9303</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">const</span> GET_PET_TOWER_ACHIEVE:<span class="built_in">uint</span> = <span class="number">3453</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">const</span> RECEIVE_PRANKSTER_REWARD:<span class="built_in">uint</span> = <span class="number">1014</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">const</span> TOPFIGHT_RANKING_LIST:<span class="built_in">uint</span> = <span class="number">2459</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">const</span> TOPFIGHT_GET_AWARD:<span class="built_in">uint</span> = <span class="number">9374</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">const</span> TOPFIGHT_WEEK_WIN:<span class="built_in">uint</span> = <span class="number">2532</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">const</span> TOPFIGHT_BEYOND:<span class="built_in">uint</span> = <span class="number">2567</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œè¿™é‡Œåªåˆ—ä¸¾å…¶ä¸­ä¸€ç§ï¼Œæœ€å¼€å§‹æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶çš„æ–¹æ³•æˆ‘å¿˜è®°äº†ï¼Œä¸Šè¿°æ–¹æ³•æ˜¯ä¸´æ—¶æ‰¾çš„ã€‚</p>
<h4 id="æ‰¾å‡ºä¿®æ”¹Keyçš„ä½ç½®"><a href="#æ‰¾å‡ºä¿®æ”¹Keyçš„ä½ç½®" class="headerlink" title="æ‰¾å‡ºä¿®æ”¹Keyçš„ä½ç½®"></a>æ‰¾å‡ºä¿®æ”¹Keyçš„ä½ç½®</h4><p>å›åˆ°è¿™é‡Œï¼Œæ—¢ç„¶æ‰¾ä¸åˆ°ä¿®æ”¹<code>key</code>çš„ä½ç½®ï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆä½¿ç”¨å½“å‰å·²ç»å¾—åˆ°çš„è§£å¯†ç®—æ³•å¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œè§£å¯†ï¼Œè¿™é‡Œé€‰ç”¨<code>Hook</code>æ³¨å…¥çš„æ–¹æ³•ï¼ˆç°åœ¨ä¸æ¸…æ¥šä¸ç”¨ç€æ€¥ï¼Œåé¢ä¼šä»‹ç»çš„ï¼‰ï¼Œè§£å¯†å¾—åˆ°çš„ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[2025-07-03 15:22:54.849] [ThreadID 0xfb8] [Temp] [Hooked send] Parsed Data:[Length=17 Version=49 CmdID=111 Cmd=â€”â€”â€”â€” UserID=123456789 SN=0 BodySize=0] </span><br><span class="line">[2025-07-03 15:22:54.874] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=21 Version=0 CmdID=111 Cmd=â€”â€”â€”â€” UserID=123456789 SN=0 BodySize=4] Body=[00 00 00 00 ]</span><br><span class="line">[2025-07-03 15:22:54.878] [ThreadID 0xfb8] [Temp] [Hooked send] Parsed Data:[Length=37 Version=49 CmdID=109 Cmd=SYS_ROLE UserID=123456789 SN=0 BodySize=20] Body=[a4 0e a7 cc 84 21 87 f2 f6 91 51 9a 7a 0e b7 6e ...]</span><br><span class="line">[2025-07-03 15:22:54.903] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=21 Version=0 CmdID=109 Cmd=SYS_ROLE UserID=123456789 SN=0 BodySize=4] Body=[00 00 00 00 ]</span><br><span class="line">[2025-07-03 15:22:54.905] [ThreadID 0xfb8] [Temp] [Hooked send] Parsed Data:[Length=37 Version=49 CmdID=105 Cmd=COMMEND_ONLINE UserID=123456789 SN=0 BodySize=20] Body=[a4 0e a7 cc 84 21 87 f2 f6 91 51 9a 7a 0e b7 6e ...]</span><br><span class="line">[2025-07-03 15:22:54.934] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=561 Version=0 CmdID=105 Cmd=COMMEND_ONLINE UserID=123456789 SN=0 BodySize=544] Body=[00 00 0b 99 00 00 00 03 00 79 ec 33 00 00 00 02 ...]</span><br><span class="line">[2025-07-03 15:23:06.439] [ThreadID 0xfb8] [Temp] [Hooked send] Parsed Data:[Length=141 Version=49 CmdID=1001 Cmd=LOGIN_IN UserID=123456789 SN=202 BodySize=124] Body=[a4 0e a7 cc 84 21 87 f2 f6 91 51 9a 7a 0e b7 6e ...]</span><br><span class="line">[2025-07-03 15:23:06.989] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=171 Version=62 CmdID=8002 Cmd=SYSTEM_MESSAGE UserID=123456789 SN=0 BodySize=154] Body=[00 01 88 43 68 66 2f da 00 00 00 8e 20 e7 b2 be ...]</span><br><span class="line">[2025-07-03 15:23:06.995] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=171 Version=62 CmdID=8002 Cmd=SYSTEM_MESSAGE UserID=123456789 SN=0 BodySize=154] Body=[00 01 88 43 68 66 2f da 00 00 00 8e 20 e7 b2 be ...]</span><br><span class="line">[2025-07-03 15:23:06.996] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=113 Version=62 CmdID=8002 Cmd=SYSTEM_MESSAGE UserID=123456789 SN=0 BodySize=96] Body=[00 01 88 43 68 66 2f da 00 00 00 54 e5 a6 82 e6 ...]</span><br><span class="line">[2025-07-03 15:23:06.996] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=129 Version=62 CmdID=8002 Cmd=SYSTEM_MESSAGE UserID=123456789 SN=0 BodySize=112] Body=[00 00 00 03 68 66 2f da 00 00 00 64 20 e4 bd a0 ...]</span><br><span class="line">[2025-07-03 15:23:06.997] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=25 Version=62 CmdID=3452 Cmd=LASTVALUE UserID=123456789 SN=0 BodySize=8] Body=[00 00 00 7f 00 00 00 32 ]</span><br><span class="line">[2025-07-03 15:23:06.997] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=25 Version=62 CmdID=3452 Cmd=LASTVALUE UserID=123456789 SN=0 BodySize=8] Body=[00 00 00 63 00 00 00 02 ]</span><br><span class="line">[2025-07-03 15:23:06.997] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=25 Version=62 CmdID=2394 Cmd=PET_BOOK_UPDATE UserID=123456789 SN=0 BodySize=8] Body=[00 00 05 1c 00 00 00 01 ]</span><br><span class="line">[2025-07-03 15:23:06.998] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=25 Version=62 CmdID=3452 Cmd=LASTVALUE UserID=123456789 SN=0 BodySize=8] Body=[00 00 00 2b 00 00 00 3c ]</span><br><span class="line">[2025-07-03 15:23:06.998] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=25 Version=62 CmdID=3452 Cmd=LASTVALUE UserID=123456789 SN=0 BodySize=8] Body=[00 00 00 2b 00 00 00 00 ]</span><br><span class="line">[2025-07-03 15:23:06.998] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=25 Version=62 CmdID=3452 Cmd=LASTVALUE UserID=123456789 SN=0 BodySize=8] Body=[00 00 00 2b 00 00 01 54 ]</span><br><span class="line">[2025-07-03 15:23:06.998] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=25 Version=62 CmdID=3452 Cmd=LASTVALUE UserID=123456789 SN=0 BodySize=8] Body=[00 00 00 2b 00 00 08 8b ]</span><br><span class="line">[2025-07-03 15:23:06.999] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=25 Version=62 CmdID=3452 Cmd=LASTVALUE UserID=123456789 SN=0 BodySize=8] Body=[00 00 00 2b 00 00 0a 31 ]</span><br><span class="line">[2025-07-03 15:23:07.031] [ThreadID 0xfb8] [Temp] [Hooked recv] Parsed Data:[Length=3413 Version=62 CmdID=1001 Cmd=LOGIN_IN UserID=123456789 SN=46 BodySize=3396] Body=[0d b2 32 92 4d 71 dc 79 e7 89 9b e6 8e 92 00 00 ...]</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œåªæˆªå–æ­£å¸¸çš„éƒ¨åˆ†ï¼ˆ<code>UserID</code>æˆ‘å°±ç”¨â€123456â€ä»£æ›¿äº†ï¼‰ï¼Œä»æ¥æ”¶åˆ°<code>LOGIN_IN</code>æŒ‡ä»¤ä»¥åï¼Œæ•°æ®å˜å¾—éå¸¸å¥‡æ€ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>key</code>å€¼çš„æ”¹å˜å‘ç”Ÿåœ¨æ¥æ”¶åˆ°<code>LOGIN_IN</code>æŒ‡ä»¤åï¼</p>
<p>åœ¨æ–‡ä»¶å¤¹ä¸­æœç´¢<code>LOGIN_IN</code>ï¼Œç»“æœä¸å¤šï¼ŒæŒ¨ä¸ªæŸ¥çœ‹ä¸‹ï¼Œæœ€åé”å®šåœ¨<code>MainEntry.as</code>ï¼š</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> function <span class="title">onLogin</span>(<span class="params">param1:SocketEvent</span>) : <span class="keyword">void</span></span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">if</span>(SaveUserInfo.loginIDInfo.loginType == <span class="number">3</span>)</span><br><span class="line">   &#123;</span><br><span class="line">      StatManager.sendStat2014(<span class="string">&quot;æ‰‹æœºéªŒè¯ç æ³¨å†Œ/ç™»å½•&quot;</span>,<span class="string">&quot;ã€æ‰‹æœºéªŒè¯ç ç™»å½•ç©å®¶ã€‘ç™»å½•ONLINEæœ&quot;</span>,<span class="string">&quot;æ‰‹æœºéªŒè¯ç &quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span>(MainManager.isNewUser)</span><br><span class="line">   &#123;</span><br><span class="line">      StatManager.sendStat2014(<span class="string">&quot;_newtrans_&quot;</span>,<span class="string">&quot;fOnlineSucc&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span>(!isReconnect)</span><br><span class="line">   &#123;</span><br><span class="line">      SocketConnection.removeCmdListener(CommandID.LOGIN_IN,onLogin);</span><br><span class="line">      EventManager.addEventListener(RobotEvent.CREATED_ACTOR,onCreatedActor);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   &#123;</span><br><span class="line">      SocketConnection.removeCmdListener(CommandID.RELOGIN_IN,onLogin);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">var</span> _loc2_:<span class="built_in">int</span> = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">if</span>(isReconnect)</span><br><span class="line">   &#123;</span><br><span class="line">      _loc2_ = <span class="built_in">int</span>(MainManager.actorInfo.mapID);</span><br><span class="line">   &#125;</span><br><span class="line">   MainManager.setup(param1.data,isReconnect,_loc2_);</span><br><span class="line">   <span class="keyword">var</span> _loc3_:ByteArray = param1.data <span class="keyword">as</span> ByteArray;</span><br><span class="line">   <span class="keyword">var</span> _loc4_:<span class="built_in">int</span> = <span class="built_in">int</span>(_loc3_.readUnsignedInt());</span><br><span class="line">   initKey(_loc4_);</span><br><span class="line">   MainEntry.login10004 = <span class="literal">false</span>;</span><br><span class="line">   LevelManager.openMouseEvent();</span><br><span class="line">   <span class="keyword">if</span>(isReconnect)</span><br><span class="line">   &#123;</span><br><span class="line">      MainManager.reconnectRequest();</span><br><span class="line">      EventManager.dispatchEvent(<span class="keyword">new</span> Event(ReconnectCompleteController.RECONNECTSUC));</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span>(!isReconnect)</span><br><span class="line">   &#123;</span><br><span class="line">      MapConfig.setup();</span><br><span class="line">      MapSeatPointConfig.setup();</span><br><span class="line">   &#125;</span><br><span class="line">   sendSystemInfo();</span><br><span class="line">   SocketConnection.send(<span class="number">1022</span>,<span class="number">86066824</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªç‰¹åˆ«æ˜¾çœ¼çš„å‡½æ•°ï¼š<code>initKey(_loc4_)</code></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> function <span class="title">initKey</span>(<span class="params">param1:<span class="built_in">int</span></span>) : <span class="keyword">void</span></span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">var</span> _loc2_:String = <span class="string">&quot;c&amp;o&amp;m.--rob-ot.c--o-r-e.&amp;n-et.S-oc-ke-t&amp;C-on-n-e-c-t-i-on&quot;</span>;</span><br><span class="line">   <span class="keyword">var</span> _loc3_:* = <span class="string">&quot;s*e*tE&amp;&amp;&amp;n*c&quot;</span>;</span><br><span class="line">   _loc3_ += <span class="string">&quot;r*yp*t&amp;&amp;&amp;&amp;Ke*yS*tr*i&amp;n&amp;&amp;g*Arr&quot;</span>;</span><br><span class="line">   _loc2_ = StringUtil.replace(_loc2_,<span class="string">&quot;-&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">   _loc2_ = StringUtil.replace(_loc2_,<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">   _loc3_ = StringUtil.replace(_loc3_,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">   _loc3_ = StringUtil.replace(_loc3_,<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">   param1 ^= MainManager.actorInfo.userID;</span><br><span class="line">   <span class="keyword">var</span> _loc4_:String = MD5.hash(param1 + <span class="string">&quot;&quot;</span>);</span><br><span class="line">   <span class="keyword">var</span> _loc5_:* = MainManager.actorInfo.userID + <span class="string">&quot;&quot;</span>;</span><br><span class="line">   <span class="keyword">var</span> _loc6_:Array = [];</span><br><span class="line">   <span class="keyword">var</span> _loc7_:<span class="built_in">int</span> = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">while</span>(_loc7_ &lt; <span class="number">10</span>)</span><br><span class="line">   &#123;</span><br><span class="line">      _loc6_[_loc7_] = <span class="string">&quot;*&quot;</span> + _loc4_.charAt(_loc7_) + <span class="string">&quot;*&quot;</span>;</span><br><span class="line">      _loc7_++;</span><br><span class="line">   &#125;</span><br><span class="line">   getDefinitionByName(_loc2_)[_loc3_](_loc6_);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¤„ç†ä¸€ä¸‹ï¼Œå°±å¯ä»¥çš„å¾—åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_loc2_ = &quot;com.robot.core.net.SocketConnection&quot;;</span><br><span class="line">_loc3_ = &quot;setEncryptKeyStringArr&quot;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™ç§é¿å…ç›´æ¥é€šè¿‡å­—ç¬¦ä¸²æœç´¢çš„æ–¹æ³•å­¦åˆ°äº†ï¼</p>
</blockquote>
<p>å‘ç°æ²¡ï¼Œ<code>_loc3_</code>å°±æ˜¯æˆ‘ä»¬å‰é¢åªèƒ½æ‰¾åˆ°ä¸€å¤„è°ƒç”¨çš„æ–¹æ³•<code>setEncryptKeyStringArr</code>ã€‚</p>
<h3 id="åˆ¶ä½œæˆ‘ä»¬è‡ªå·±çš„Hook"><a href="#åˆ¶ä½œæˆ‘ä»¬è‡ªå·±çš„Hook" class="headerlink" title="åˆ¶ä½œæˆ‘ä»¬è‡ªå·±çš„Hook"></a>åˆ¶ä½œæˆ‘ä»¬è‡ªå·±çš„Hook</h3><h4 id="æœ¬æ–‡ä¸­æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#æœ¬æ–‡ä¸­æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="æœ¬æ–‡ä¸­æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>æœ¬æ–‡ä¸­æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h4><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬çš„æœ€ç»ˆç›®çš„æ˜¯å¯¹ç½‘ç»œé€šä¿¡ä¸­çš„æ•°æ®åŒ…è¿›è¡Œè§£å¯†ï¼Œå› æ­¤å¦‚ä½•æ•è·æ•°æ®éå¸¸é‡è¦ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç›®çš„ï¼Œå°±éœ€è¦è¯·å‡ºæœ¬èŠ‚ä¸»è§’ï¼šHookï¼</p>
<h4 id="ä»€ä¹ˆæ˜¯Hook"><a href="#ä»€ä¹ˆæ˜¯Hook" class="headerlink" title="ä»€ä¹ˆæ˜¯Hook?"></a>ä»€ä¹ˆæ˜¯Hook?</h4><p>Hookï¼Œåˆç§°é’©å­ï¼Œæ˜¯ä¸€ç§èƒ½å¤Ÿæ‹¦æˆªå’Œä¿®æ”¹å‡½æ•°æˆ–æ–¹æ³•çš„æŠ€æœ¯ã€‚å®ƒå…è®¸å¼€å‘è€…åœ¨ä¸ä¿®æ”¹åŸæœ‰çš„ä»£ç å‰æä¸‹ï¼Œä¿®æ”¹ç¨‹åºçš„è¡Œä¸ºã€‚</p>
<p>ä¾‹å¦‚åœ¨ç½‘ç»œé€šä¿¡ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æˆ‘ä»¬é€šè¿‡<strong>Hook</strong>æ‹¦æˆªç½‘ç»œAPIçš„è°ƒç”¨ï¼Œä¾‹å¦‚<code>send</code>ã€<code>recv</code>ç­‰ï¼Œè¿™æ ·å°±å¯ä»¥æ•è·ç½‘ç»œé€šä¿¡ä¸­çš„ä¸€æ®µ<strong>åå…­è¿›åˆ¶</strong>æ•°æ®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3c 3f 78 6d 6c 20 76 65 72 73 69 6f 6e 3d 22 31 2e 30 22 3f 3e 3c 21 44 4f 43 54 59 50 45 20 63 72 6f 73 73 2d 64 6f 6d 61 69 6e 2d 70 6f 6c 69 63 79 3e 3c 63 72 6f 73 73 2d 64 6f 6d 61 69 6e 2d 70 6f 6c 69 63 79 3e 3c 61 6c 6c 6f 77 2d 61 63 63 65 73 73 2d 66 72 6f 6d 20 64 6f 6d 61 69 6e 3d 22 2a 22 20 74 6f 2d 70 6f 72 74 73 3d 22 2a 22 20 2f 3e 3c 2f 63 72 6f 73 73 2d 64 6f 6d 61 69 6e 2d 70 6f 6c 69 63 79 3e 00</span><br></pre></td></tr></table></figure>

<p>å°†å…¶è½¬æ¢ä¸º<strong>ASCIIå­—ç¬¦</strong>å°±å¯ä»¥å¾—åˆ°ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">cross-domain-policy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cross-domain-policy</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">allow-access-from</span> <span class="attr">domain</span>=<span class="string">&quot;*&quot;</span> <span class="attr">to-ports</span>=<span class="string">&quot;*&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">cross-domain-policy</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å½“ç„¶äº†ï¼Œè¿™ä¸ªè‚¯å®šæ˜¯æˆ‘ä»¬ä¸éœ€è¦çš„æ•°æ®ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œ<strong>Hook</strong>åœ¨æœ¬æ–‡çš„ä½œç”¨å°±æ˜¯æ•è·æˆ‘ä»¬éœ€è¦åˆ†æçš„æ•°æ®åŒ…ã€‚</p>
<h4 id="Hooké€‰æ‹©"><a href="#Hooké€‰æ‹©" class="headerlink" title="Hooké€‰æ‹©"></a>Hooké€‰æ‹©</h4><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<strong>Hook</strong>éƒ½æ˜¯ä»¥<strong>DLL</strong>çš„å½¢å¼æ³¨å…¥åˆ°è¿›ç¨‹ä¸­ï¼Œç„¶åå¯¹è¿›ç¨‹è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿéœ€è¦åˆ¶ä½œ<strong>DLL</strong>æ–‡ä»¶ã€‚</p>
<blockquote>
<p>è€ƒè™‘åˆ°ä½¿ç”¨WindowsåŸç”ŸAPIå®ç°Hookéš¾åº¦ä¸å°ï¼Œå› æ­¤æœ¬æ–‡é‡‡ç”¨ç¬¬ä¸‰æ–¹å¼€æºåº“<strong>MinHook</strong>ã€‚</p>
<p>é“¾æ¥ï¼š<a href="https://github.com/TsudaKageyu/minhook">https://github.com/TsudaKageyu/minhook</a></p>
</blockquote>
<p><strong>MinHook</strong>çš„å®ç°å°±éå¸¸æ–¹ä¾¿äº†ï¼Œå¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line"><span class="function">MH_STATUS WINAPI <span class="title">MH_Initialize</span><span class="params">(VOID)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºé’©å­ pTargetï¼šéœ€è¦æ›¿æ¢çš„ç›®æ ‡å‡½æ•°åœ°å€ã€‚ pDetourï¼šæˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„å‡½æ•°åœ°å€ã€‚ ppOriginalï¼šç”¨äºä¿å­˜åŸå§‹å‡½æ•°æŒ‡é’ˆï¼ˆæ–¹ä¾¿ç»•è¿‡Hookï¼‰</span></span><br><span class="line"><span class="function">MH_STATUS WINAPI <span class="title">MH_CreateHook</span><span class="params">(LPVOID pTarget, LPVOID pDetour, LPVOID *ppOriginal)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨é’©å­</span></span><br><span class="line"><span class="function">MH_STATUS WINAPI <span class="title">MH_EnableHook</span><span class="params">(LPVOID pTarget)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// å…³é—­é’©å­</span></span></span><br><span class="line"><span class="function">MH_STATUS WINAPI <span class="title">MH_DisableHook</span><span class="params">(LPVOID pTarget)</span></span></span><br><span class="line"><span class="function">    </span></span><br><span class="line"><span class="function"><span class="comment">// æ”¶å·¥åçš„ä¸€äº›å¤„ç†</span></span></span><br><span class="line"><span class="function">MH_STATUS WINAPI <span class="title">MH_Uninitialize</span><span class="params">(VOID)</span></span>;</span><br></pre></td></tr></table></figure>

<h4 id="Hookåˆå§‹åŒ–"><a href="#Hookåˆå§‹åŒ–" class="headerlink" title="Hookåˆå§‹åŒ–"></a>Hookåˆå§‹åŒ–</h4><p>åœ¨åˆå§‹åŒ–å‰å‘¢ï¼Œæˆ‘ä»¬åº”å½“æ˜ç¡®éœ€è¦æ‹¦æˆªçš„åœ°æ–¹ï¼Œè¿™é‡Œå°±ä¸å¾—ä¸æåˆ°<code>ws2_32.dll</code>è¿™ä¸ªæ–‡ä»¶äº†ã€‚</p>
<p><code>ws2_32.dll</code>æ˜¯Windows Sockets APIçš„å®ç°ï¼Œé€šå¸¸ç½‘ç»œé€šä¿¡éƒ½ä¼šç”¨åˆ°å®ƒï¼Œä»¥<code>Flash</code>ç«¯ä¸ºä¾‹ï¼Œæ•°æ®ä¼ è¾“çš„è¿‡ç¨‹ä¸­é€šå¸¸ä¼šè°ƒç”¨<code>send</code>å’Œ<code>recv</code>æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æ‹¦æˆªè¿™ä¸¤ä¸ªæ–¹æ³•å³å¯ã€‚</p>
<p>æ ¹æ®<strong>MinHook</strong>æä¾›çš„åˆå§‹åŒ–åŠæ³•ï¼Œæˆ‘ä»¬éœ€è¦è·å–ï¼š</p>
<ul>
<li><code>pTarget</code>ï¼šéœ€è¦æ›¿æ¢çš„ç›®æ ‡å‡½æ•°åœ°å€ã€‚  </li>
<li><code>pDetour</code>ï¼šæˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„å‡½æ•°åœ°å€ã€‚</li>
<li><code>ppOriginal</code>ï¼šç”¨äºä¿å­˜åŸå§‹å‡½æ•°æŒ‡é’ˆï¼ˆæ–¹ä¾¿ç»•è¿‡Hookï¼‰ã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¦–å…ˆåŠ è½½ws2_32.dll</span></span><br><span class="line">HMODULE ws2_32 = <span class="literal">nullptr</span>;</span><br><span class="line">ws2_32 = <span class="built_in">GetModuleHandleW</span>(<span class="string">L&quot;ws2_32&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å‡½æ•°åœ°å€</span></span><br><span class="line">LPVOID targetSend = <span class="built_in">reinterpret_cast</span>&lt;LPVOID&gt;(<span class="built_in">GetProcAddress</span>(ws2_32, <span class="string">&quot;send&quot;</span>));</span><br><span class="line">LPVOID targetRecv = <span class="built_in">reinterpret_cast</span>&lt;LPVOID&gt;(<span class="built_in">GetProcAddress</span>(ws2_32, <span class="string">&quot;recv&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰åŸå§‹å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line"><span class="keyword">decltype</span>(&amp;recv) originalRecv = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="keyword">decltype</span>(&amp;send) originalSend = <span class="literal">nullptr</span>;</span><br></pre></td></tr></table></figure>

<h4 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h4><p>åˆ«ç€æ€¥ï¼Œæ•è·æ•°æ®å‰è¿˜éœ€è¦äº†è§£ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š<strong>ç®¡é“</strong>ã€‚</p>
<p>å…ˆæ˜ç¡®æˆ‘ä»¬çš„éœ€æ±‚ï¼š</p>
<p>å‡è®¾ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªDLLç”¨äºæ³¨å…¥æ¸¸æˆè¿›ç¨‹æ¥æ•è·æ•°æ®åŒ…ï¼Œç„¶åï¼Œæˆ‘ä»¬å¦æœ‰ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦å¯¹æ•è·åˆ°çš„æ•°æ®åŒ…è¿›è¡Œå¤„ç†ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦ä¸€ä¸ªç¨‹åºæ˜¯æ€ä¹ˆå¾—åˆ°DLLæ•è·åˆ°çš„æ•°æ®åŒ…å‘¢ï¼Ÿ</p>
<p>ç›¸ä¿¡ä½ ä¹ŸçŸ¥é“ç­”æ¡ˆäº†ï¼Œå½“ç„¶æ˜¯å€ŸåŠ©<strong>ç®¡é“</strong>è¿™ä¸ªå·¥å…·ã€‚</p>
<p>OKï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯ç®¡é“ï¼Ÿ</p>
<p>ç®¡é“ï¼ˆPipeï¼‰æ˜¯<strong>æ“ä½œç³»ç»Ÿ</strong>ä¸­ä¸€ç§éå¸¸åŸºç¡€ä¸”é‡è¦çš„<strong>è¿›ç¨‹é—´é€šä¿¡</strong>æœºåˆ¶ã€‚ç®¡é“çš„æœ¬è´¨æ˜¯ä¸€ä¸ª<strong>å…±äº«çš„ã€ç‰¹æ®Šçš„æ–‡ä»¶æˆ–å†…æ ¸ç¼“å†²åŒº</strong>ã€‚å®ƒå…è®¸ä¸€ä¸ªè¿›ç¨‹å°†æ•°æ®å†™å…¥è¿™ä¸ªç¼“å†²åŒºï¼Œè€Œå¦ä¸€ä¸ªè¿›ç¨‹ä»è¿™ä¸ªç¼“å†²åŒºè¯»å–æ•°æ®ã€‚æ•°æ®åœ¨ç®¡é“ä¸­ä»¥<strong>å­—èŠ‚æµ</strong>çš„å½¢å¼å•å‘æµåŠ¨ã€‚ï¼ˆAIå¦‚æ˜¯è¯´ï¼‰</p>
<p>é€šå¸¸å‘¢ï¼Œç®¡é“åˆ†ä¸º<strong>åŒ¿åç®¡é“</strong>ä¸<strong>å‘½åç®¡é“</strong>ã€‚åŒ¿åç®¡é“ä¸€èˆ¬æ˜¯ç”¨ä½œ<strong>å…·å¤‡</strong>äº²ç¼˜å…³ç³»çš„è¿›ç¨‹ä¹‹é—´ä½¿ç”¨çš„ï¼Œè€Œå‘½åç®¡é“æ˜¯ç”¨ä½œ<strong>æ²¡æœ‰</strong>äº²ç¼˜å…³ç³»çš„è¿›ç¨‹ä¹‹é—´é€šä¿¡çš„ã€‚</p>
<p>ç®¡é“æœ‰äº›ç±»ä¼¼æ•°æ®å’Œç»“æ„ä¸­çš„<strong>é˜Ÿåˆ—</strong>ï¼Œå®ƒé‡‡ç”¨çš„æ˜¯å…ˆè¿›å…ˆå‡ºçš„é¡ºåºï¼Œå¹¶ä¸”å®ƒæ˜¯å•å‘çš„ã€‚</p>
<p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬è¿™é‡Œéœ€è¦ä½¿ç”¨<strong>å‘½åç®¡é“</strong>ã€‚</p>
<blockquote>
<p>å…·ä½“å®ç°å°±ä¸è¯´äº†ï¼Œç›´æ¥çœ‹æºç ã€‚</p>
</blockquote>
<h4 id="æ•°æ®æ•è·"><a href="#æ•°æ®æ•è·" class="headerlink" title="æ•°æ®æ•è·"></a>æ•°æ®æ•è·</h4><p>ç»å†äº†é‚£ä¹ˆå¤šï¼Œç»ˆäºå¯ä»¥å¼€å§‹æ•è·æ•°æ®äº†ï¼Œè¿™é‡Œå°±ä»¥æ•è·æ¥æ”¶åŒ…ä¸ºä¾‹å­ï¼ˆä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œè¿™é‡Œæ²¡æœ‰ä½¿ç”¨ç®¡é“ï¼‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">Sï¼šå½“å‰æ¥æ”¶æ•°æ®çš„ç«¯ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">BufferPtrï¼šæŒ‡å‘ç¼“å†²åŒºçš„æŒ‡é’ˆï¼Œå­˜æ”¾Sæ¥æ”¶çš„æ•°æ®ã€‚</span></span><br><span class="line"><span class="comment">Lengthï¼šç¼“å†²åŒºçš„å¤§å°ã€‚</span></span><br><span class="line"><span class="comment">Flagï¼šæ¥æ”¶æ ‡å¿—ä½ï¼Œæ§åˆ¶æ¥æ”¶æ–¹å¼ã€‚ï¼ˆæœ¬æ–‡æ²¡æœ‰ç”¨åˆ°ï¼‰</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">int</span> WINAPI <span class="title">RecvEvent</span><span class="params">(SOCKET S, <span class="type">char</span> *BufferPtr, <span class="type">int</span> Length, <span class="type">int</span> Flag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> Result = <span class="built_in">OriginalRecv</span>(S, BufferPtr, Length, Flag); <span class="comment">// å®é™…æ¥æ”¶åˆ°çš„é•¿åº¦ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (g_hookEnabled &amp;&amp; Result &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(g_DataMutex)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="function">std::vector&lt;<span class="type">char</span>&gt; <span class="title">Temp</span><span class="params">(BufferPtr, BufferPtr + Result)</span></span>;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">// å¤„ç†æœ¬æ¬¡æ¥æ”¶åˆ°çš„æ•°æ®ã€‚</span></span><br><span class="line">        PacketProcessor::<span class="built_in">ProcessRecvPacket</span>(S, Temp, Result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¼€å§‹å¤„ç†æ•°æ®åŒ…ï¼"><a href="#å¼€å§‹å¤„ç†æ•°æ®åŒ…ï¼" class="headerlink" title="å¼€å§‹å¤„ç†æ•°æ®åŒ…ï¼"></a>å¼€å§‹å¤„ç†æ•°æ®åŒ…ï¼</h3><p>ç°åœ¨æ¥æ”¶åˆ°æ•°æ®åï¼Œå°±éœ€è¦æƒ³åŠæ³•å¯¹æ•°æ®è¿›è¡Œå¤„ç†äº†ã€‚</p>
<p>é¦–å…ˆæˆ‘åˆ›å»ºäº†<code>PacketProcessor</code>ç±»ï¼Œç”¨äºå¤„ç†è¿™äº›æ•°æ®ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">PacketData</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int32_t</span> Length;  <span class="comment">// åŒ…é•¿ 4å­—èŠ‚</span></span><br><span class="line">    <span class="type">uint8_t</span> Version; <span class="comment">// ç‰ˆæœ¬ 1å­—èŠ‚</span></span><br><span class="line">    <span class="type">int32_t</span> CmdID;   <span class="comment">// å‘½ä»¤å· 4å­—èŠ‚</span></span><br><span class="line">    <span class="type">int32_t</span> UserID;  <span class="comment">// ç±³ç±³å· 4å­—èŠ‚</span></span><br><span class="line">    <span class="type">int32_t</span> SN;      <span class="comment">// åºåˆ—å· 4å­—èŠ‚</span></span><br><span class="line">    std::vector&lt;<span class="type">uint8_t</span>&gt; Body;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">LogCout</span><span class="params">(<span class="type">bool</span> bIsSend)</span> <span class="type">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PacketProcessor</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">ProcessRecvPacket</span><span class="params">(SOCKET Socket, <span class="type">const</span> vector&lt;<span class="type">char</span>&gt; &amp;Data, <span class="type">int</span> Length)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">static</span> PacketData <span class="title">ParsePacket</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">uint8_t</span>&gt; &amp;Packet)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">bool</span> <span class="title">ShouldDecrypt</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">uint8_t</span>&gt; &amp;Cipher)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">static</span> vector&lt;<span class="type">uint8_t</span>&gt; <span class="title">DecryptPacket</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">uint8_t</span>&gt; &amp;Cipher)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">Logining</span><span class="params">(PacketData &amp;InPacketData)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">static</span> vector&lt;<span class="type">uint8_t</span>&gt; s_RecvBuf;</span><br><span class="line">    <span class="type">static</span> <span class="type">size_t</span> s_RecvBufIndex;</span><br><span class="line">    <span class="type">static</span> <span class="type">size_t</span> s_RecvBufLen;</span><br><span class="line">    <span class="type">static</span> <span class="type">size_t</span> s_RecvNum;</span><br><span class="line">    <span class="type">static</span> SOCKET s_CurrentSocket;</span><br><span class="line">    <span class="type">static</span> <span class="type">bool</span> s_HaveLogin;</span><br><span class="line">    <span class="type">static</span> <span class="type">size_t</span> s_SN;</span><br><span class="line">    <span class="type">static</span> <span class="type">int32_t</span> s_UserID;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä»‹ç»æœ€å…³é”®çš„<code>ProcessRecvPacket</code>å‰å‘¢ï¼Œéœ€è¦å…ˆäº†è§£ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼š<strong>ç²˜åŒ…</strong>å’Œ<strong>æ‹†åŒ…</strong>ã€<strong>å¤§ç«¯</strong>å’Œ<strong>å°ç«¯</strong>ã€‚</p>
<h4 id="ç²˜åŒ…å’Œæ‹†åŒ…"><a href="#ç²˜åŒ…å’Œæ‹†åŒ…" class="headerlink" title="ç²˜åŒ…å’Œæ‹†åŒ…"></a>ç²˜åŒ…å’Œæ‹†åŒ…</h4><p>åœ¨ä½¿ç”¨TCPåè®®è¿›è¡Œæ•°æ®ä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼ŒTCPä¼šå°†å‘é€æ–¹çš„æ•°æ®å­˜å‚¨åœ¨ç¼“å†²åŒºä¸­ï¼Œå¹¶æ ¹æ®ç½‘ç»œçŠ¶å†µä¼˜åŒ–æ•°æ®åŒ…çš„å¤§å°è¿›è¡Œä¼ è¾“ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒTCPä¸€æ¬¡ä¼ é€’æŠ¥æ–‡æ®µå¯èƒ½ç”±<strong>å¤šä¸ªå°çš„æ•°æ®åŒ…ç»„æˆ</strong>ï¼Œæ¥æ”¶æ–¹æ¥æ”¶æ—¶å°±å¯èƒ½å‡ºç°å¤šä¸ªæ•°æ®åŒ…â€œç²˜â€åœ¨ä¸€èµ·çš„ç°è±¡ï¼Œè¿™ç§æƒ…å†µå°±æ˜¯ç²˜åŒ…ï¼›åŒæ ·çš„ï¼Œå¦‚æœå•ä¸ªæ•°æ®åŒ…è¿‡å¤§ï¼Œè¶…è¿‡äº†TCP æŠ¥æ–‡æ®µçš„æœ€å¤§ä¼ è¾“å•å…ƒï¼Œé‚£ä¹ˆTCPä¼šå°†è¿™ä¸ª<strong>å¤§çš„æ•°æ®åŒ…æ‹†åˆ†</strong>ï¼Œå¹¶åˆ†ä¸ºå¤šä¸ªæŠ¥æ–‡æ®µè¿›è¡Œä¼ è¾“ï¼Œè¿™æ ·å°±é€ æˆäº†æ‹†åŒ…ã€‚</p>
<h4 id="å¤§ç«¯å’Œå°ç«¯"><a href="#å¤§ç«¯å’Œå°ç«¯" class="headerlink" title="å¤§ç«¯å’Œå°ç«¯"></a>å¤§ç«¯å’Œå°ç«¯</h4><p>å¤§å°ç«¯æ˜¯<strong>å¤šå­—èŠ‚æ•°æ®çš„å­˜å‚¨æ–¹å¼</strong>ï¼Œå®ƒå†³å®šä¸€ä¸ªå¤šå­—èŠ‚ç±»å‹åœ¨å†…å­˜ä¸­æŒ‰ç…§ä»€ä¹ˆé¡ºåºå­˜æ”¾å„ä¸ªå­—èŠ‚ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œå¯¹äºä½œä¸º<strong>æ­£å¸¸äºº</strong>çš„æˆ‘ä»¬æ¥è¯´ï¼Œå¯¹äº<code>123</code>è¿™ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬éƒ½ä¼šå°†å…¶è¯»ä½œâ€œä¸€ç™¾äºŒåä¸‰â€ï¼Œä¹Ÿå°±æ˜¯å¤§ç«¯ï¼Œå³é«˜ä½åœ¨å‰ï¼Œä½ä½åœ¨åï¼›ä½†æ˜¯ï¼Œ<strong>å¤„ç†å™¨</strong>ä¸è¿™ä¹ˆè®¤ä¸ºï¼Œå®ƒæ˜¯æ€ä¹ˆè¯»çš„å‘¢ï¼Ÿ</p>
<p>â€œä¸‰ç™¾äºŒåä¸€â€</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¸æ­£å¸¸äººè¯»å–çš„æ–¹å¼å®Œå…¨ç›¸åï¼Œé«˜ä½åœ¨åï¼Œä½ä½åœ¨å‰ã€‚ä¸‹æ–¹æ˜¯æ¯”è¾ƒä¸“ä¸šçš„ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ•´æ•° 0x12345678 çš„å­—èŠ‚æ’åˆ—ï¼š</span><br><span class="line"></span><br><span class="line">åœ°å€:   0x00  0x01  0x02  0x03</span><br><span class="line">å¤§ç«¯:   0x12  0x34  0x56  0x78</span><br><span class="line">å°ç«¯:   0x78  0x56  0x34  0x12</span><br></pre></td></tr></table></figure>

<h4 id="ProcessRecvPacket"><a href="#ProcessRecvPacket" class="headerlink" title="ProcessRecvPacket"></a>ProcessRecvPacket</h4><p>å…ˆè´´ä»£ç </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">PacketProcessor::ProcessRecvPacket</span><span class="params">(SOCKET Socket, <span class="type">const</span> vector&lt;<span class="type">char</span>&gt; &amp;Data, <span class="type">int</span> Length)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    PacketData RecvPacketData = <span class="built_in">PacketData</span>();</span><br><span class="line"></span><br><span class="line">    s_RecvBuf.<span class="built_in">insert</span>(s_RecvBuf.<span class="built_in">end</span>(), Data.<span class="built_in">begin</span>(), Data.<span class="built_in">begin</span>() + Length);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¯å¦æ˜¯åŒä¸€è¿æ¥ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (s_CurrentSocket != Socket)</span><br><span class="line">    &#123;</span><br><span class="line">        s_RecvBufIndex += Length;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ­¤æ—¶ç´¢å¼•ç­‰äºç¼“å†²åŒºé•¿åº¦ï¼Œåˆ™è¯´æ˜åˆšå¥½å–å®Œæ­¤åŒ…ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (s_RecvBufIndex == s_RecvBuf.<span class="built_in">size</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            s_RecvBuf.<span class="built_in">clear</span>();</span><br><span class="line">            s_RecvBufIndex = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">size_t</span> Remain = s_RecvBuf.<span class="built_in">size</span>() - s_RecvBufIndex;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸è¶³åŒ…å¤´é•¿åº¦ï¼Œéœ€ç­‰å¾…ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (Remain &lt; <span class="built_in">sizeof</span>(<span class="type">uint32_t</span>))</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¯»åŒ…ã€‚</span></span><br><span class="line">        <span class="type">uint32_t</span> PacketLength = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memcpy</span>(&amp;PacketLength, &amp;s_RecvBuf[s_RecvBufIndex], <span class="built_in">sizeof</span>(PacketLength));</span><br><span class="line">        PacketLength = <span class="built_in">ntohl</span>(PacketLength);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åŒ…æœªé½ï¼Œéœ€ç­‰å¾…ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (Remain &lt; PacketLength)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function">vector&lt;<span class="type">uint8_t</span>&gt; <span class="title">Cipher</span><span class="params">(s_RecvBuf.begin() + s_RecvBufIndex, s_RecvBuf.begin() + s_RecvBufIndex + PacketLength)</span></span>;</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">uint8_t</span>&gt; Plain = <span class="built_in">ShouldDecrypt</span>(Cipher) ? <span class="built_in">DecryptPacket</span>(Cipher) : Cipher;</span><br><span class="line"></span><br><span class="line">        RecvPacketData = <span class="built_in">ParsePacket</span>(Plain);</span><br><span class="line">        ++s_RecvNum;</span><br><span class="line">        RecvPacketData.<span class="built_in">LogCout</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯ç™»å½•åŒ…</span></span><br><span class="line">        <span class="keyword">if</span> (RecvPacketData.CmdID == <span class="number">1001</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">Logining</span>(RecvPacketData);</span><br><span class="line">            s_CurrentSocket = Socket;</span><br><span class="line">            s_SN = RecvPacketData.SN;</span><br><span class="line">            s_UserID = RecvPacketData.UserID;</span><br><span class="line">            s_HaveLogin = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        s_RecvBufIndex += PacketLength;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (s_RecvBufIndex == s_RecvBuf.<span class="built_in">size</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            s_RecvBuf.<span class="built_in">clear</span>();</span><br><span class="line">            s_RecvBufIndex = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (s_RecvBufIndex &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            s_RecvBuf.<span class="built_in">erase</span>(s_RecvBuf.<span class="built_in">begin</span>(), s_RecvBuf.<span class="built_in">begin</span>() + s_RecvBufIndex);</span><br><span class="line">            s_RecvBufIndex = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// s_CurrentSocket = Socket;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç§ä»¥ä¸ºå…¶ä¸­çš„é‡ç‚¹ä¸º<strong>ç²˜åŒ…</strong>ã€<strong>æ‹†åŒ…</strong>ä»¥åŠ<strong>ç™»å½•åŒ…çš„å¤„ç†</strong>çš„è§£å†³æ–¹æ³•ã€‚</p>
<p>å…ˆè¯´<strong>ç²˜åŒ…</strong>å’Œ<strong>æ‹†åŒ…</strong>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">size_t</span> Remain = s_RecvBuf.<span class="built_in">size</span>() - s_RecvBufIndex;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸è¶³åŒ…å¤´é•¿åº¦ï¼Œéœ€ç­‰å¾…ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (Remain &lt; <span class="built_in">sizeof</span>(<span class="type">uint32_t</span>))</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯»åŒ…ã€‚</span></span><br><span class="line">    <span class="type">uint32_t</span> PacketLength = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;PacketLength, &amp;s_RecvBuf[s_RecvBufIndex], <span class="built_in">sizeof</span>(PacketLength));</span><br><span class="line">    PacketLength = <span class="built_in">ntohl</span>(PacketLength);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŒ…æœªé½ï¼Œéœ€ç­‰å¾…ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (Remain &lt; PacketLength)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;<span class="type">uint8_t</span>&gt; <span class="title">Cipher</span><span class="params">(s_RecvBuf.begin() + s_RecvBufIndex, s_RecvBuf.begin() + s_RecvBufIndex + PacketLength)</span></span>;</span><br><span class="line"></span><br><span class="line">    vector&lt;<span class="type">uint8_t</span>&gt; Plain = <span class="built_in">ShouldDecrypt</span>(Cipher) ? <span class="built_in">DecryptPacket</span>(Cipher) : Cipher;</span><br><span class="line"></span><br><span class="line">    RecvPacketData = <span class="built_in">ParsePacket</span>(Plain);</span><br><span class="line">    ++s_RecvNum;</span><br><span class="line">    RecvPacketData.<span class="built_in">LogCout</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯ç™»å½•åŒ…</span></span><br><span class="line">    <span class="keyword">if</span> (RecvPacketData.CmdID == <span class="number">1001</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">Logining</span>(RecvPacketData);</span><br><span class="line">        s_CurrentSocket = Socket;</span><br><span class="line">        s_SN = RecvPacketData.SN;</span><br><span class="line">        s_UserID = RecvPacketData.UserID;</span><br><span class="line">        s_HaveLogin = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    s_RecvBufIndex += PacketLength;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (s_RecvBufIndex == s_RecvBuf.<span class="built_in">size</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        s_RecvBuf.<span class="built_in">clear</span>();</span><br><span class="line">        s_RecvBufIndex = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (s_RecvBufIndex &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        s_RecvBuf.<span class="built_in">erase</span>(s_RecvBuf.<span class="built_in">begin</span>(), s_RecvBuf.<span class="built_in">begin</span>() + s_RecvBufIndex);</span><br><span class="line">        s_RecvBufIndex = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// s_CurrentSocket = Socket;</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘åˆ›å»ºäº†å¤šä¸ªå…¨å±€å˜é‡ç”¨äºå¤„ç†ä¸Šè¿°é—®é¢˜ï¼š</p>
<ul>
<li><code>s_RecvBuf</code>ï¼š<strong>æ¥æ”¶ç¼“å†²åŒº</strong>ï¼Œç”¨äºç¼“å­˜æ¥æ”¶æ¥çš„æ•°æ®æµã€‚</li>
<li><code>s_RecvBufIndex</code>ï¼š<strong>å½“å‰</strong>å¤„ç†åˆ°çš„æ¥æ”¶ç¼“å†²åŒº<strong>ç´¢å¼•</strong>ã€‚</li>
</ul>
<p>å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>åˆ¤å¤´é•¿ï¼Œå…ˆåˆ¤æ–­åŒ…å¤´é•¿åº¦æ˜¯å¦è¶³å¤Ÿï¼Œä¸å¤Ÿåˆ™ç»§ç»­ç­‰å¾…æ–°çš„åŒ…ã€‚</li>
<li>è¯»åŒ…å¤´ï¼Œå°†ç½‘ç»œå­—èŠ‚åºï¼ˆå¤§ç«¯ï¼‰è½¬æ¢ä¸ºæœºå™¨è¯»æ³•ï¼ˆå°ç«¯ï¼‰å¾—åˆ°åŒ…é•¿ã€‚</li>
<li>åˆ¤åŒ…é•¿ï¼Œåˆ¤æ–­å½“å‰ç¼“å†²åŒºçš„åŒ…æ˜¯å¦å®Œæ•´ï¼Œä¸å®Œæ•´ç»§ç»­ç­‰ã€‚</li>
<li>åˆ†æåŒ…ï¼Œæå–å®Œæ•´çš„æ•°æ®åŒ…ï¼Œè¿›è¡Œè§£å¯†åˆ†æã€‚</li>
<li>æ¸…åº“å­˜ï¼Œæ›´æ–°ç¼“å†²åŒºçš„çŠ¶æ€ï¼Œç¡®ä¿ä¸ä¼šå½±å“ä¸‹ä¸€è½®çš„åˆ†æã€‚</li>
</ol>
<p>å†è¯´<strong>ç™»é™†åŒ…çš„å¤„ç†ï¼š</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (RecvPacketData.CmdID == <span class="number">1001</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">Logining</span>(RecvPacketData);</span><br><span class="line">    s_CurrentSocket = Socket;</span><br><span class="line">    s_SN = RecvPacketData.SN;</span><br><span class="line">    s_UserID = RecvPacketData.UserID;</span><br><span class="line">    s_HaveLogin = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éå¸¸çš„æ¸…æ™°ï¼Œå¦‚æœå‘½ä»¤å·ä¸º<code>1001</code>ï¼Œå°±ä»£è¡¨æ­¤æ—¶ä¸ºç™»å½•åŒ…ï¼Œç„¶åä¾ç…§å®˜æ–¹å¤„ç†æ–¹æ³•ï¼Œå¯¹<code>key</code>è¿›è¡Œå¤„ç†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">PacketProcessor::Logining</span><span class="params">(PacketData &amp;InPacketData)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (InPacketData.Body.<span class="built_in">size</span>() &lt; <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. å–å°¾ 4 å­—èŠ‚å¹¶æŒ‰â€œå¤§ç«¯â€ç»„è£…</span></span><br><span class="line">    <span class="type">size_t</span> n = InPacketData.Body.<span class="built_in">size</span>();</span><br><span class="line">    <span class="type">uint32_t</span> tail4 = (<span class="built_in">static_cast</span>&lt;<span class="type">uint32_t</span>&gt;(InPacketData.Body[n - <span class="number">1</span>])) | (<span class="built_in">static_cast</span>&lt;<span class="type">uint32_t</span>&gt;(InPacketData.Body[n - <span class="number">2</span>]) &lt;&lt; <span class="number">8</span>) | (<span class="built_in">static_cast</span>&lt;<span class="type">uint32_t</span>&gt;(InPacketData.Body[n - <span class="number">3</span>]) &lt;&lt; <span class="number">16</span>) | (<span class="built_in">static_cast</span>&lt;<span class="type">uint32_t</span>&gt;(InPacketData.Body[n - <span class="number">4</span>]) &lt;&lt; <span class="number">24</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. å¼‚æˆ– userId</span></span><br><span class="line">    <span class="type">uint32_t</span> xorRes = tail4 ^ <span class="built_in">static_cast</span>&lt;<span class="type">uint32_t</span>&gt;(InPacketData.UserID);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. è½¬ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">    std::string plain = std::<span class="built_in">to_string</span>(xorRes);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. è®¡ç®— MD5</span></span><br><span class="line">    MD5 md5;</span><br><span class="line">    md<span class="number">5.</span><span class="built_in">update</span>(<span class="built_in">reinterpret_cast</span>&lt;<span class="type">const</span> <span class="type">uint8_t</span> *&gt;(plain.<span class="built_in">data</span>()), plain.<span class="built_in">size</span>());</span><br><span class="line">    md<span class="number">5.f</span>inalize();</span><br><span class="line">    std::string md5hex = md<span class="number">5.</span><span class="built_in">hexdigest</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. å–å‰ 10 å­—ç¬¦ä½œå¯†é’¥</span></span><br><span class="line">    std::string key = md5hex.<span class="built_in">substr</span>(<span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–åŠ å¯†ç®—æ³•</span></span><br><span class="line">    Cryptor::<span class="built_in">InitKey</span>(key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œæˆ‘ä»¬å°±å¾—åˆ°çš„å…³é”®é“å…·ï¼š<code>key</code>ã€‚åœ¨è¿™ä¹‹åå‘¢ï¼Œæ‰€æœ‰çš„æ•°æ®åŒ…çš„è§£å¯†éƒ½ä¼šç”¨åˆ°<code>key</code>ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥éšæ„åœ°æ•è·å¹¶è§£å¯†å°åŒ…äº†ã€‚</p>
<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>ç™»å½•é˜¶æ®µï¼Œå¯ä»¥çœ‹åˆ°<code>LOGIN_IN</code>æŒ‡ä»¤åˆ†åˆ«è¿›è¡Œäº†ä¸€æ¬¡å‘é€ä¸ä¸€æ¬¡æ¥æ”¶ã€‚</p>
<p><img src="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704232253744.jpg"></p>
<p>å°è¯•ç§»åŠ¨ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°<code>PEOPLE_WALK</code>åˆ†åˆ«è¢«å‘é€å’Œæ¥æ”¶äº†ä¸€æ¬¡ï¼Œè‡³äºæ—¥å¿—ä¸­ä¸ºä»€ä¹ˆæ˜¯ä¸¤æ¬¡ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡æ²¡æˆªå¥½å›¾ã€‚</p>
<p><img src="https://blog-1314504743.cos.ap-nanjing.myqcloud.com/image-20250704232406825.jpg"></p>
<p>é‚£ä¹ˆåˆ°è¿™é‡Œï¼Œå°åŒ…è§£å¯†åŸºæœ¬ç»“æŸäº†ï¼Œä¸‹é¢è¿›å…¥ç¬¬äºŒé˜¶æ®µï¼š</p>
<p><strong>â€œå¯¹æˆ˜ä¿¡æ¯æ•è·ä¸UIå±•ç¤ºâ€</strong></p>
<p>è¿™éƒ¨åˆ†å°±è‡ªè¡Œç ”ç©¶å§ï¼</p>
<h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>æœ¬æ–‡ä»…ç”¨äº<strong>æŠ€æœ¯ç ”ç©¶ä¸å­¦ä¹ äº¤æµ</strong>ï¼Œè¯·å‹¿ç”¨äºä»»ä½•å•†ä¸šç”¨é€”ã€‚</p>
<p>æ‰€æœ‰ç›¸å…³èµ„æºç‰ˆæƒå½’<strong>ä¸Šæµ·æ·˜ç±³ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸</strong>æ‰€æœ‰ã€‚</p>
<p>å¦‚å› æ»¥ç”¨æœ¬æ–‡é€ æˆæ³•å¾‹çº çº·ï¼Œ<strong>è´£ä»»ç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…</strong>ã€‚</p>
<p>æœ¬æ–‡å‚è€ƒè‡ª<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1468888-1-1.html">èµ›å°”å·ï¼šé€šä¿¡åè®®é€†å‘ä¸æ¨¡æ‹Ÿ&amp;ä¸­é—´äººæ”»å‡»çªƒå–ç™»å½•å‡­è¯</a></p>
<p><strong>è”ç³»æ–¹å¼</strong></p>
<p>é‚®ç®±ï¼š<a href="mailto:&#x35;&#x38;&#x34;&#x34;&#56;&#53;&#51;&#x32;&#x31;&#x40;&#x71;&#x71;&#x2e;&#x63;&#x6f;&#109;">584485321@qq.com</a></p>
<hr>
<p>é‚£ä¹ˆæœ€åï¼Œèµ›å°”å·è§ï¼ï¼ï¼</p>
<hr>
</div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2025/02/13/Note/"><span class="level-item">éšè®°</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-3-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/Hinami-Aoi.jpg" alt="Orcaä¸¶"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Orcaä¸¶</p><p class="is-size-6 is-block">çˆ±å¼€å‘æ¸¸æˆçš„èœé¸Ÿä¸€æš</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives/"><p class="title">2</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories/"><p class="title">1</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags/"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/dauphinYan" target="_blank" rel="me noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/dauphinYan"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">ç›®å½•</h3><ul class="menu-list"><li><a class="level is-mobile" href="#å‰è¨€"><span class="level-left"><span class="level-item">å‰è¨€</span></span></a></li><li><a class="level is-mobile" href="#è·å–Flashæ–‡ä»¶å¹¶åç¼–è¯‘"><span class="level-left"><span class="level-item">è·å–Flashæ–‡ä»¶å¹¶åç¼–è¯‘</span></span></a></li><li><a class="level is-mobile" href="#å°è¯•è¯»æºç ï¼"><span class="level-left"><span class="level-item">å°è¯•è¯»æºç ï¼</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#é€šä¿¡æ•°æ®è§£å¯†"><span class="level-left"><span class="level-item">é€šä¿¡æ•°æ®è§£å¯†</span></span></a></li><li><a class="level is-mobile" href="#æ•°æ®åŒ…æ ¼å¼è§£æ"><span class="level-left"><span class="level-item">æ•°æ®åŒ…æ ¼å¼è§£æ</span></span></a></li><li><a class="level is-mobile" href="#æ‰¾å‡ºä¿®æ”¹Keyçš„ä½ç½®"><span class="level-left"><span class="level-item">æ‰¾å‡ºä¿®æ”¹Keyçš„ä½ç½®</span></span></a></li></ul></li><li><a class="level is-mobile" href="#åˆ¶ä½œæˆ‘ä»¬è‡ªå·±çš„Hook"><span class="level-left"><span class="level-item">åˆ¶ä½œæˆ‘ä»¬è‡ªå·±çš„Hook</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#æœ¬æ–‡ä¸­æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><span class="level-left"><span class="level-item">æœ¬æ–‡ä¸­æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</span></span></a></li><li><a class="level is-mobile" href="#ä»€ä¹ˆæ˜¯Hook"><span class="level-left"><span class="level-item">ä»€ä¹ˆæ˜¯Hook?</span></span></a></li><li><a class="level is-mobile" href="#Hooké€‰æ‹©"><span class="level-left"><span class="level-item">Hooké€‰æ‹©</span></span></a></li><li><a class="level is-mobile" href="#Hookåˆå§‹åŒ–"><span class="level-left"><span class="level-item">Hookåˆå§‹åŒ–</span></span></a></li><li><a class="level is-mobile" href="#ç®¡é“"><span class="level-left"><span class="level-item">ç®¡é“</span></span></a></li><li><a class="level is-mobile" href="#æ•°æ®æ•è·"><span class="level-left"><span class="level-item">æ•°æ®æ•è·</span></span></a></li></ul></li><li><a class="level is-mobile" href="#å¼€å§‹å¤„ç†æ•°æ®åŒ…ï¼"><span class="level-left"><span class="level-item">å¼€å§‹å¤„ç†æ•°æ®åŒ…ï¼</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ç²˜åŒ…å’Œæ‹†åŒ…"><span class="level-left"><span class="level-item">ç²˜åŒ…å’Œæ‹†åŒ…</span></span></a></li><li><a class="level is-mobile" href="#å¤§ç«¯å’Œå°ç«¯"><span class="level-left"><span class="level-item">å¤§ç«¯å’Œå°ç«¯</span></span></a></li><li><a class="level is-mobile" href="#ProcessRecvPacket"><span class="level-left"><span class="level-item">ProcessRecvPacket</span></span></a></li></ul></li><li><a class="level is-mobile" href="#æµ‹è¯•"><span class="level-left"><span class="level-item">æµ‹è¯•</span></span></a></li><li><a class="level is-mobile" href="#æœ€å"><span class="level-left"><span class="level-item">æœ€å</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">åˆ†ç±»</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/%E8%B5%9B%E5%B0%94%E5%8F%B7%E9%80%86%E5%90%91/"><span class="level-start"><span class="level-item">èµ›å°”å·é€†å‘</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-07-03T07:47:54.000Z">2025-07-03</time></p><p class="title"><a href="/2025/07/03/game-reversing/network-protocol-reversing/">èµ›å°”å·é€†å‘ï¼šå°åŒ…åˆ†æ</a></p><p class="categories"><a href="/categories/%E8%B5%9B%E5%B0%94%E5%8F%B7%E9%80%86%E5%90%91/">èµ›å°”å·é€†å‘</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-02-13T09:56:21.000Z">2025-02-13</time></p><p class="title"><a href="/2025/02/13/Note/">éšè®°</a></p></div></article></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/favicon.ico" alt="Orcaä¸¶çš„åšå®¢" height="28"></a><p class="is-size-7"><span>&copy; 2025 Orcaä¸¶</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "æ­¤ç½‘ç«™ä½¿ç”¨Cookieæ¥æ”¹å–„æ‚¨çš„ä½“éªŒã€‚",
          dismiss: "çŸ¥é“äº†ï¼",
          allow: "å…è®¸ä½¿ç”¨Cookie",
          deny: "æ‹’ç»",
          link: "äº†è§£æ›´å¤š",
          policy: "Cookieæ”¿ç­–",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script></body></html>